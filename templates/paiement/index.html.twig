{% extends 'base.html.twig' %}

{% block title %}Paiement
	{{ type }}
	- CHM Saleux
{% endblock %}

{% block body %}
	<style>
		/* üåê Structure globale */
		body {
			scroll-behavior: smooth;
			background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
		}

		/* ‚úÖ Conteneur principal */
		.paiement-wrapper {
			min-height: calc(100vh - 100px);
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: flex-start;
			padding-top: 140px;
			padding-bottom: 40px;
		}

		/* ‚úÖ Texte d'intro avec animation */
		.paiement-wrapper h1 {
			font-weight: 700;
			font-size: 2.25rem;
			background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			margin-bottom: 16px;
			animation: slideDown 0.6s ease-out;
		}

		.paiement-wrapper p {
			max-width: 800px;
			margin: 0 auto 30px;
			font-size: 1.05rem;
			line-height: 1.7;
			color: #4a5568;
		}

		/* ‚úÖ Conteneur iframe avec effet de profondeur */
		.payment-container {
			width: 100%;
			max-width: 1050px;
			margin: 20px auto;
			border-radius: 16px;
			overflow: hidden;
			box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08), 0 2px 8px rgba(0, 0, 0, 0.04);
			background: #fff;
			display: flex;
			align-items: center;
			justify-content: center;
			border: 1px solid rgba(0, 0, 0, 0.05);
			transition: transform 0.3s ease, box-shadow 0.3s ease;
			animation: fadeInUp 0.8s ease-out;
		}

		.payment-container:hover {
			transform: translateY(-2px);
			box-shadow: 0 15px 50px rgba(0, 0, 0, 0.12), 0 4px 12px rgba(0, 0, 0, 0.06);
		}

		.payment-container iframe {
			width: 100%;
			height: calc(100vh - 250px);
			border: none;
		}

		/* ‚úÖ Badge s√©curis√© */
		.text-muted.small {
			display: inline-flex;
			align-items: center;
			gap: 8px;
			padding: 12px 24px;
			background: #f0fdf4;
			border: 1px solid #86efac;
			border-radius: 50px;
			color: #166534;
			font-weight: 500;
			font-size: 0.95rem;
		}

		/* ‚úÖ Bouton retour am√©lior√© */
		.btn-outline-primary {
			font-weight: 600;
			padding: 12px 32px;
			border: 2px solid #0066cc;
			border-radius: 50px;
			color: #0066cc;
			background: transparent;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			box-shadow: 0 2px 8px rgba(0, 102, 204, 0.1);
		}

		.btn-outline-primary:hover {
			background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%);
			color: #fff;
			transform: translateY(-2px);
			box-shadow: 0 8px 20px rgba(0, 102, 204, 0.3);
			border-color: #0066cc;
		}

		.btn-outline-primary:active {
			transform: translateY(0);
			box-shadow: 0 2px 8px rgba(0, 102, 204, 0.2);
		}

		/* ‚úÖ Overlay avec effet moderne */
		#loaderOverlay {
			position: fixed;
			inset: 0;
			background: rgba(255, 255, 255, 0.75);
			backdrop-filter: blur(12px) saturate(150%);
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 9999;
			transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1);
		}

		/* ‚úÖ Loader moderne */
		.loader-content {
			text-align: center;
			animation: fadeIn 0.8s ease;
		}

		.spinner {
			width: 70px;
			height: 70px;
			border: 5px solid rgba(0, 102, 204, 0.12);
			border-top: 5px solid #0066cc;
			border-right: 5px solid #0099ff;
			border-radius: 50%;
			animation: spin 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
			margin: 0 auto 24px;
			filter: drop-shadow(0 2px 8px rgba(0, 102, 204, 0.15));
		}

		.loader-content p {
			font-size: 1.1rem;
			font-weight: 600;
			color: #2d3748;
			letter-spacing: -0.01em;
		}

		/* ‚úÖ Animations raffin√©es */
		@keyframes spin {
			from {
				transform: rotate(0deg);
			}
			to {
				transform: rotate(360deg);
			}
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
				transform: scale(0.95);
			}
			to {
				opacity: 1;
				transform: scale(1);
			}
		}

		@keyframes slideDown {
			from {
				opacity: 0;
				transform: translateY(-20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		/* ‚úÖ Responsive optimis√© */
		@media(max-width: 768px) {
			.paiement-wrapper {
				padding-top: 120px;
				padding-left: 16px;
				padding-right: 16px;
			}

			.paiement-wrapper h1 {
				font-size: 1.75rem;
			}

			.paiement-wrapper p {
				font-size: 0.95rem;
			}

			.payment-container {
				border-radius: 12px;
				margin: 16px auto;
			}

			.payment-container iframe {
				height: calc(100vh - 220px);
			}

			.text-muted.small {
				font-size: 0.85rem;
				padding: 10px 20px;
			}

			.btn-outline-primary {
				padding: 10px 24px;
				font-size: 0.95rem;
			}
		}

		@media(max-width: 480px) {
			.paiement-wrapper h1 {
				font-size: 1.5rem;
			}

			.spinner {
				width: 55px;
				height: 55px;
			}
		}
	</style>

	<div class="paiement-wrapper">
		<div class="container text-center">
			<h1>üí≥ Paiement en ligne -
				{{ type }}</h1>
			<p>
				Effectuez votre paiement pour la formule
				<strong>{{ type }}</strong>
				directement via HelloAsso.<br>
				Ce service est
				<strong>100 % s√©curis√©</strong>
				et sans frais pour le club.
			</p>

			<div id="paymentContainer" class="payment-container">
				<iframe id="helloassoIframe" src="{{ iframeUrl }}" frameborder="0"></iframe>
			</div>

			<p class="text-muted small mt-4">
				üü¢ Paiement g√©r√© par HelloAsso ‚Äî plateforme s√©curis√©e et gratuite pour les associations.
			</p>

			<div class="mt-4">
				<a href="{{ path('home') }}" class="btn btn-outline-primary rounded-pill px-4 py-2">
					‚Üê Retour aux abonnements
				</a>
			</div>
		</div>
	</div>

	<!-- üåÄ Overlay de chargement -->
	<div id="loaderOverlay">
		<div class="loader-content">
			<div class="spinner"></div>
			<p>Chargement du formulaire s√©curis√© HelloAsso...</p>
		</div>
	</div>

	 <script>
		document.addEventListener('DOMContentLoaded', function() {
		    const iframe = document.getElementById('helloassoIframe');
		    const loader = document.getElementById('loaderOverlay');
		
		    let iframeLoaded = false;
		    let minTimeElapsed = false;
		
		    // d√©lai minimum 2 secondes
		    setTimeout(() => {
		        minTimeElapsed = true;
		        if (iframeLoaded) hideLoader();
		    }, 2000);
		
		    iframe.addEventListener('load', function() {
		        iframeLoaded = true;
		        if (minTimeElapsed) hideLoader();
		    });
		
		    function hideLoader() {
		        loader.style.opacity = '0';
		        setTimeout(() => loader.style.display = 'none', 600);
		    }
		});
		</script>
{% endblock %}
